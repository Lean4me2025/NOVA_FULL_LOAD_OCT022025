<!doctype html><html><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Nova • Categories</title><link rel="stylesheet" href="assets/css/style.css"/>
<script defer src="assets/js/state.js"></script><script defer src="assets/js/data.js"></script></head>
<body><div class="container"><div class="header"><div class="brand">Nova</div><div class="badge">Selected: <span id="count">0</span> / 2–4</div></div>
<div class="card"><h1 class="h1">Choose categories that resonate with your life, your experiences, and the work that excites you.</h1>
<div id="cats" class="grid cols-4"></div>
<div class="hr"></div><div class="grid cols-2"><button id="next" class="btn primary" type="button">Next • Select Traits</button><button id="clear" class="btn ghost" type="button">Clear</button></div>
</div></div>
<script>
(async ()=>{
  const data = await loadAllData();
  const cats = data.categories;
  const selectedIds = new Set(NOVA.state.selectedCategoryIds||JSON.parse(localStorage.getItem('nova.selectedCategoryIds')||'[]'));
  const selectedLabels = new Set(NOVA.state.selectedCategories||JSON.parse(localStorage.getItem('nova.selectedCategories')||'[]'));
  const root = document.getElementById('cats'); root.innerHTML='';
  cats.forEach(c=>{
    const b=document.createElement('button'); b.className='category-card btn ghost'; b.textContent=c.label; b.dataset.id=c.id;
    if(selectedIds.has(c.id)) b.classList.add('active');
    b.onclick=()=>{ if(selectedIds.has(c.id)){selectedIds.delete(c.id); selectedLabels.delete(c.label); b.classList.remove('active');}
                    else {selectedIds.add(c.id); selectedLabels.add(c.label); b.classList.add('active');}
                    save(); renderCount(); };
    root.appendChild(b);
  });
  function save(){
    const ids=[...selectedIds], labels=[...selectedLabels];
    localStorage.setItem('nova.selectedCategoryIds', JSON.stringify(ids));
    localStorage.setItem('nova.selectedCategories', JSON.stringify(labels));
    NOVA.state.selectedCategoryIds = ids; NOVA.state.selectedCategories = labels; NOVA.save();
  }
  function renderCount(){ document.getElementById('count').textContent = selectedIds.size; }
  document.getElementById('next').onclick=()=>{ if(selectedIds.size<2) return; save(); location.href='traits.html'; };
  document.getElementById('clear').onclick=()=>{ selectedIds.clear(); selectedLabels.clear(); document.querySelectorAll('.category-card').forEach(b=> b.classList.remove('active')); save(); renderCount(); };
  renderCount();
})();
</script></body></html>
