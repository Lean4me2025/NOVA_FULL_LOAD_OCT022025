<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>NOVA · Role Reveal</title><link rel="stylesheet" href="assets/css/style.css"/></head><body><div class="wrap"><h1>Your Role Reveal</h1>
<div class="card" id="result"></div><div class="card" id="alt"></div><div class="card"><h2>What this means</h2><p class="small">This isn’t a label—it’s a signal.</p></div>
<div class="bar"><div class="small" id="meta"></div><div><a class="btn" href="traits.html">Back</a><a class="btn" href="reflection_look_back.html">Next: Reflection</a></div></div></div>
<script type="module">import {{ readJSON, get, set }} from './assets/js/shared.js'; const traits=get('selectedTraits',[]); const cats=get('selectedCategories',[]);
function score(role,map){{ const tm=traits.filter(t=>(role.trait_weights||[]).includes(t)).length; let dm=0; traits.forEach(t=>{{ const d=map[t]||[]; if((role.attribute_weights||[]).some(x=>d.includes(x))) dm+=1; }}); return {{score:2*tm+dm, tm, dm}}; }}
const FALLBACK_TEXT={{"Arts & Media":"Creative expression and communication.","Business":"Planning, structure, and improvement.","Technology":"Problem-solving and systems.","Education & Community":"Mentoring and service.","Public Safety":"Accountability and protection.","Healthcare":"Care, precision, and patience.","Science & Research":"Curiosity and testing.","Skilled Trades":"Hands-on craft and quality.","Finance & Accounting":"Numbers, accuracy, integrity.","Operations & Logistics":"Flow and reliability.","Sales & Marketing":"Communication and persuasion.","Law & Government":"Fairness and process.","Essential & Everyday Workers":"Service, reliability, teamwork."}};
Promise.all([readJSON('/data/roles.json'), readJSON('/data/trait_to_attributes.json')]).then(([roles,map])=>{{ const scored=roles.map(r=>({{...r, __:score(r,map)}})).sort((a,b)=>b.__.score-a.__.score); const top=scored[0]; const alt=scored[1];
 if(!top||top.__.score<=0){{ const cat=cats[0]||'Essential & Everyday Workers'; const payload={{ id:`fallback-${{cat}}`, title:`${{cat}} Role`, summary:FALLBACK_TEXT[cat]||'', jobs:[], isFallback:true, tm:0, dm:0, traits, categories:cats }}; set('revealedRole',payload);
 document.getElementById('result').innerHTML=`<h2>${{cat}} Role</h2><p class='small'>${{FALLBACK_TEXT[cat]||''}}</p><hr/><div class='small'>You chose: ${traits.join(', ')||'—'}</div>`; document.getElementById('alt').innerHTML=''; document.getElementById('meta').textContent=`Based on ${traits.length} selected trait${traits.length===1?'':'s'}.`; return; }}
 const payload={{ id:top.id, title:top.title, summary:top.summary, jobs:top.jobs||[], isFallback:false, tm:top.__.tm, dm:top.__.dm, traits, categories:cats }}; set('revealedRole',payload);
 document.getElementById('result').innerHTML=`<h2>${{top.title}}</h2><p class='small'>${{top.summary}}</p><hr/><div class='small'>Best fit by: <b>${{top.__.tm}}</b> trait matches · <b>${{top.__.dm}}</b> attribute matches.</div><div class='small'>Try these roles: ${(top.jobs||[]).join(', ')||'—'}</div>`;
 document.getElementById('alt').innerHTML = alt? `<h2>Also Consider: ${{alt.title}}</h2><p class='small'>${{alt.summary}}</p><div class='small'>Roles: ${(alt.jobs||[]).join(', ')||'—'}</div>` : '';
 document.getElementById('meta').textContent=`Based on ${traits.length} selected trait${traits.length===1?'':'s'}.`; }});
</script></body></html>