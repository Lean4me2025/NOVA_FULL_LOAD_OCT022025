<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Nova â€¢ Plans</title>
  <link rel="stylesheet" href="/assets/css/style.css"/>
  <script defer src="/assets/js/state.js"></script>
</head>
<body>
<div class="container">
  <div class="header">
    <div class="brand">Nova</div>
    <div class="list"><a class="pill" href="/reflection.html">Back</a></div>
    <div class="badge">Payhip</div>
  </div>
  <div class="card">
    <h1 class="h1">Choose your plan</h1>
    <div id="plans" class="grid cols-3"></div>
    <div class="hr"></div>
    <a class="btn primary" href="/navi.html">Continue to Navi</a>
  </div>
</div>
<script>
async function loadConfig(){
  try{
    const r = await fetch('/assets/config.json', {cache:'no-store'});
    return await r.json();
  }catch(e){
    return {payhip:{starter:'#',pro:'#',mastery:'#'}};
  }
}
(async ()=>{
  const cfg = await loadConfig();
  const plans = [
    {id:'starter', name:'NAVI Starter', price:'$29.99/mo', url: cfg.payhip.starter},
    {id:'pro', name:'NAVI Pro', price:'$99/mo', url: cfg.payhip.pro},
    {id:'mastery', name:'Mastery', price:'$149.99/mo', url: cfg.payhip.mastery}
  ];
  const root = document.getElementById('plans');
  plans.forEach(p=>{
    const el = document.createElement('div');
    el.className='card';
    el.innerHTML = `<div class="kicker">${p.price}</div><div class="h2">${p.name}</div>
      <p class="p">Everything you need to move from clarity to action.</p>
      <div class="grid"><a class="btn block" href="${p.url}" target="_blank">Buy on Payhip</a>
      <button class="btn ghost block" data-id="${p.id}">Select Plan</button></div>`;
    root.appendChild(el);
  });
  root.addEventListener('click', e=>{
    const btn = e.target.closest('button[data-id]');
    if(!btn) return;
    NOVA.state.plan = btn.dataset.id;
    NOVA.save();
    alert('Selected plan: '+NOVA.state.plan.toUpperCase());
  });
})();
</script>
</body>
</html>
